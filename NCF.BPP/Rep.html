<!DOCTYPE html>
<html>
<head>
    <title></title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <style type="text/css">
        html, body {
            height: 100%;
            margin: 0;
        }

        #reportContainer {
            height: 100%; 
        }
    </style>
    <script src="https://npmcdn.com/es6-promise@3.2.1"></script>
<!--
    <link rel="stylesheet" type="text/css" href="~/Content/style/style.css">
-->
    <script src="scripts/powerbi.js"></script>
</head>
<body>
    <div id="reportContainer"></div>
    <script>
        function init(title, embed_config) {
            //alert("init");
            //var models = window['powerbi-client'].models;

            //var config = {
            //    type: 'report',
            //    tokenType: embed_config.tokenType,
            //    accessToken: embed_config.accessToken,
            //    embedUrl: embed_config.embedUrl,
            //    id: embed_config.id,
            //    permissions: embed_config.permissions,
            //    settings: embed_config.settings
            //};

            //var config = {
            //    type: 'report',
            //    tokenType: models.TokenType.Embed,
            //    accessToken: embed_config.accessToken,
            //    embedUrl: embed_config.embedUrl,
            //    id: embed_config.id,
            //    permissions: models.Permissions.All,
            //    settings: {
            //        filterPaneEnabled: true,
            //        navContentPaneEnabled: true
            //    }
            //};
            //var config = {
            //    type: 'report',
            //    tokenType: embed_config.tokenType,
            //    accessToken: embed_config.accessToken,
            //    embedUrl: embed_config.embedUrl,
            //    id: embed_config.id,
            //    permissions: embed_config.permissions,
            //    settings: {
            //        filterPaneEnabled: embed_config.settings.filterPaneEnabled,
            //        navContentPaneEnabled: embed_config.settings.navContentPaneEnabled
            //    }
            //};

            //function configConstructor(cfg) {
            //    function settingConstructor(sett) {
            //        for (var k in sett) this[k] = sett[k];
            //    }
            //    for (var k in cfg) this[k] = cfg[k];
            //    this.settings = new settingConstructor(cfg.settings);
            //};
            function _clone(cfg) {
                for (var k in cfg) {
                    if (typeof(cfg[k]) === 'object') 
                        this[k] = new _clone(cfg[k]);
                    else
                        this[k] = cfg[k];
                }
            };

            //debugger;
            //var config = new configConstructor(embed_config);
            try {
                var config = new _clone(embed_config);
                var reportContainer = document.getElementById('reportContainer');
                var reportFrame = powerbi.embed(reportContainer, config);
                reportFrame.fullscreen();
                document.title = title;
            }
            catch (err) {
                alert("Error: " + err);
            }
       }
    </script>
</body>
</html>
